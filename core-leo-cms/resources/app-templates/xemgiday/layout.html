<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">

    <header class="mdl-layout__header mdl-layout__header--waterfall portfolio-header">

        <div class="mdl-layout__header-row portfolio-logo-row">
            <span class="mdl-layout__title">
                <a href="/">
                    <div class="header-logo"></div>
                </a>
                <span class="mdl-layout__title">{{defaultPageTitle}}</span>
            </span>
        </div>

    </header>

    <div id="page_navigator_desktop" style="visibility: hidden;"
        class="mdl-layout__header-row portfolio-navigation-row mdl-layout--large-screen-only">
        <nav class="mdl-navigation mdl-typography--body-1-force-preferred-font">
            <!-- main header pages -->
            <a class="mdl-navigation__link " href="/">Trang chủ</a>
            {{#each topPageNavigators}}
            <a class="mdl-navigation__link " href="{{uri}}" id="page_{{id}}" >{{name}}</a>
            {{/each}}
        </nav>
    </div>
    <div id="page_navigator_mobile" class="mdl-layout__drawer mdl-layout--small-screen-only">
        <nav class="mdl-navigation mdl-typography--body-1-force-preferred-font">
            <!-- main header pages -->
            {{#each topPageNavigators}}               
                <a class="mdl-navigation__link" href="{{uri}}" id="page_{{id}}" >{{name}}</a>              
            {{/each}}           
        </nav>
    </div>   


    <main class="mdl-layout__content">

        <!-- TODO -->
        <div class="mdl-tabs__tab-bar" >
            <a href="/" title="Home" class="mdl-tabs__tab is-active"><i class="material-icons">home</i></a>
            <a href="/html/most-favorite" title="Favorite" class="mdl-tabs__tab"><i class="material-icons">favorite</i></a>
            <a href="/html/most-trending" class="mdl-tabs__tab"><i class="material-icons">trending_up</i></a>
            <a href="/html/music-playlist" class="mdl-tabs__tab"><i class="material-icons">music_video</i></a>
            <a id="user-menu" href="#" class="mdl-tabs__tab" style="display: none;" ><i class="material-icons">account_box</i></a>

            <!-- Menu items List , mdl-menu--bottom-right -->
            <ul class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="user-menu">
                <li class="mdl-menu__item">Profile</li>
                <li class="mdl-menu__item">My Bookmarks</li>
                <li disabled class="mdl-menu__item">Log out</li>
            </ul>
        </div>

        <div class="mdl-grid portfolio-max-width">
            <!-- main content here -->
            {{#doIf templateName '==' "index" }}

            <!-- Ads -->
            <div id="headerAdPlacement" class="mdl-card__actions mdl-card--border mdl-typography--text-center">
                <strong>Advertiment</strong>
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9034869050940123"
                    data-ad-slot="1376192829" data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>

            {{#each headlines}}
            {{#renderHtmlView "xemgiday/widgets/item-post" this }}{{/renderHtmlView}}
            {{/each}}

            {{#doIf customData.nextStartIndex '>' 0 }}
            <div id="loadMore">
                <a href="/?startIndex={{customData.nextStartIndex}}&numberResult=9">Load More</a>
            </div>
            {{/doIf}}

            {{/doIf}}

            <!-- ////////////// -->
            {{#doIf templateName '==' "single-category" }}
            {{#renderHtmlView "xemgiday/single-category" this }}{{/renderHtmlView}}
            {{/doIf}}

            {{#doIf templateName '==' "single-page" }}
                <!-- Ads -->
                <div id="headerAdPlacement" class="mdl-card__actions mdl-card--border mdl-typography--text-center">
                    <strong>Advertiment</strong>
                    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9034869050940123"
                        data-ad-slot="1376192829" data-ad-format="auto" data-full-width-responsive="true"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

                {{#each pages}}
                {{#renderHtmlView "xemgiday/single-page" this }}{{/renderHtmlView}}
                {{/each}}

                {{#doIf customData.nextStartIndex '>' 0 }}
                <div id="loadMore">
                    <a href="{{customData.currentPath}}?startIndex={{customData.nextStartIndex}}&numberResult=6">Load
                        More</a>
                </div>
                {{/doIf}}
            {{/doIf}}

            {{#doIf templateName '==' "single-post" }}
            <!-- the list has one item only -->
            <div class="mdl-cell mdl-cell--12-col mdl-card mdl-shadow--4dp">
                <!-- Ads -->
                <div style="display: none" id="articleAdPlacement" class="mdl-card__actions mdl-card--border mdl-typography--text-center">
                    <strong>Advertiment</strong>                    
                </div>

                {{#each posts}}
                {{#renderHtmlView "xemgiday/single-post" this }}{{/renderHtmlView}}
                {{/each}}
                <script>
                    window.contextPageId = '{{contextPageId}}';  
                </script>

                <div id="relatedPostsPlacement" class="mdl-cell mdl-cell--12-col">
                    <h5 style="text-transform:uppercase">Có thể bạn quan tâm</h5>
                    <ul class="demo-list-three mdl-list">
                        {{#each recommendedPosts}}
                        {{#renderHtmlView "xemgiday/widgets/suggested-item-post" this }}{{/renderHtmlView}}
                        {{/each}}
                    </ul>
                </div>

                <div id="bottomAdPlacement" class="mdl-card__actions mdl-card--border mdl-typography--text-center">
                    <!-- XemGiDay-BottomAds -->
                    <strong>Advertiment</strong>
                    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9034869050940123"
                        data-ad-slot="7360035298" data-ad-format="auto" data-full-width-responsive="true"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>
            </div>
            <!-- ////////////// -->
            {{/doIf}}


            {{#doIf templateName '==' "list-category" }}
            {{#renderHtmlView "xemgiday/list-category" this }}{{/renderHtmlView}}
            {{/doIf}}

            {{#doIf templateName '==' "list-page" }}
            {{#renderHtmlView "xemgiday/list-page" this }}{{/renderHtmlView}}
            {{/doIf}}

            {{#doIf templateName '==' "list-post" }}
            {{#each posts}}
            {{#renderHtmlView "xemgiday/list-post" this }}{{/renderHtmlView}}
            {{/each}}
            {{/doIf}}

            <!-- ////////////// -->
            {{#doIf templateName '==' "404" }}
            {{#renderHtmlView "xemgiday/404" this }}{{/renderHtmlView}}
            {{/doIf}}


        </div>

        <footer class="mdl-mini-footer">
            <div class="mdl-mini-footer__left-section">
                <div class="mdl-logo">{{pageTitle}}</div>
            </div>
            <div class="mdl-mini-footer__right-section">
                <ul class="mdl-mini-footer__link-list">
                    <!-- main bottom pages -->
                    <li><a href="#">Help</a></li>
                </ul>
            </div>
        </footer>
    </main>
</div>

<script>
    //data for personalization 
    //window.topPageNavigators = {{#toJson topPageNavigators }}{{/toJson}};      
    window.usersession = lscache.get('usersession') || '';
    window.currentUserProfile = false;

    function loadSessionUserInfo(callback){
        if(window.usersession != ''){
            var urlStr = '/user/get-info';
            LeoCmsApiUtil.callPostAdminApi(urlStr, {}, function (json) {
                if (json.httpCode === 0 && json.errorMessage === '') {
                    if (json.data) {
                        var user = json.data;                    
                        window.currentUserProfile = user;                        
                    }
                    if(typeof callback === 'function') callback(); 
                }
            }); 
        } else {
            if(typeof callback === 'function') callback();
        }      
    }
    function canEditPost(postOwnerId){
        return window.currentUserProfile && window.currentUserProfile.key === postOwnerId;
    }   
    
    (function () {
        var uri = location.href.split(location.host)[1] || '';
        uri = uri.toLowerCase();
        if (uri === '/') {
            $('a[href="/"]').addClass('is-active');
        } else {
            if(uri.indexOf('/html/post/' && window.contextPageId) === 0){
                $('#page_'+ window.contextPageId).addClass('is-active');
            } else {
                $('a[href^="' + uri + '"]').addClass('is-active');
            }            
        }
        $('#page_navigator_desktop').css('visibility', 'visible')
    }());
</script>