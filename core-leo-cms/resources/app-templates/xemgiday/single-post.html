<div id="post_title" class="mdl-card__title mdl-typography--display-1" style="justify-content: center;">
    {{title}}
</div>

<div id="postMainContent" class="portfolio-copy">
    
    <div class="mdl-cell mdl-cell--12-col mdl-typography--text-right" style="font-weight: bold">
        Posted by: {{#userDisplayName ownerId }}{{/userDisplayName}}
        <a id="btnEditPost" target="_blank" href="/admin#calljs-postInfo('{{id}}')" style="display: none"> Edit </a>
    </div>
    
    <div id="postMediaVideo" class="mdl-cell mdl-cell--12-col ">
        <!-- video loader -->
        <div id="videoProgressLoader" style="margin: auto"
            class="mdl-cell--6-col mdl-progress mdl-js-progress mdl-progress__indeterminate"></div>

        <!-- Video Holder -->
        <div id="videoholder_outer" class="videoholder_outer" style='background-image: url("{{headlineImageUrl}}");' >
            <div id="videoPlaceholder" class="videoholder" data-video-thumbnail="{{headlineImageUrl}}"                
                data-video-source="{{{headlineVideoUrl}}}">
            </div>
        </div>
    </div>

    <!-- main actions -->
    <div id="postMediaAction" class="mdl-card__actions mdl-card--border mdl-typography--text-center">
        <a id="arrow_back" href="#" style="float: left;"><i class="material-icons">arrow_back</i></a>

        <button class="mdl-button mdl-button--icon mdl-button--colored"><i class="material-icons">favorite</i></button>
        <button id="btnPlayerVolume" onclick="volumePlayerUp()"
            class="mdl-button mdl-button--icon mdl-button--colored"><i class="material-icons">volume_up</i></button>
        <button id="btnPlayerFullscreen" title="Play in fullscreen" onclick="showPlayerInFullscreen()"
            class="mdl-button mdl-button--icon mdl-button--colored"><i class="material-icons">fullscreen</i></button>

        <!-- sharing menu -->
        <button id="my-menu-bottom-right" class="mdl-button mdl-js-button mdl-button--icon">
            <i class="material-icons">share</i>
        </button>
        <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="my-menu-bottom-right">
            <a id="fbSharer" href="#" target="_blank">
                <li class="mdl-menu__item">Facebook</li>
            </a>
            <li style="display: none" class="mdl-menu__item">Twitter</li>
            <li style="display: none" class="mdl-menu__item">Bookmark</li>
        </ul>    

        <a id="arrow_forward" style="float:right" href="#"><i class="material-icons">arrow_forward</i></a>
    </div>

    <strong id="postMediaDescription" class="mdl-cell mdl-cell--12-col">{{description}}</strong>

    <div class="mdl-card__actions mdl-card--border mdl-typography--text-left" >
        <b>Keywords:</b>
        {{#each keywords}}        
            <a href="/html/top-posts-by-keywords/?keywords={{.}}">{{.}}</a> &nbsp;
        {{/each}}
    </div>

    <div id="postMediaInfo" class="mdl-cell mdl-cell--12-col mdl-card__supporting-text no-padding ">
        {{{mediaInfo}}}
    </div>

    <div id="fbLikeBox" class="mdl-cell mdl-cell--12-col" style="display: none">
        <div style="margin: auto!important;width: 340px!important;display: block!important" class="fb-page"
            data-href="https://www.facebook.com/xemgiday.tv/" data-small-header="true" data-adapt-container-width="true"
            data-hide-cover="false" data-show-facepile="true">
            <blockquote cite="https://www.facebook.com/xemgiday.tv/" class="fb-xfbml-parse-ignore"><a
                    href="https://www.facebook.com/xemgiday.tv/">Xem
                    Gì Đây</a></blockquote>
        </div>
    </div>

</div>
<script>
    window.debugMediaPlayerOne = false;
    var autoplayVideo = true;
    var isYoutube = false;
    var playerReadyCalled = false;

    function playerReady() {
        playerReadyCalled = true;
        $('#videoholder_outer').css('background-image', 'none');
        //if (!window.isMobile) 
        {
            setTimeout(function () {
                window.player.muted(false);
                window.player.volume(0.6);
            }, 6000);
        }
    }

    function loadVideo() {
        var pmHolderId = 'videoPlaceholder';

        var videoSrc = $('#' + pmHolderId).attr('data-video-source').trim();
        if (videoSrc != '') {
            isYoutube = videoSrc.indexOf('youtube.com') > 0;

            //var adUrl = 'https://static.blueseed.tv/v2cdn/vast/vast-1557911759536.xml?cb=' + new Date().getTime();
            //var adUrl = 'https://d1.blueseed.tv/vast??plm=1064&li=3765';

            var adUrls = [];
            var skipTime = 3; // show skip button after 3 seconds            
            var adConfigs = [];

            window.player = MediaPlayerOne.create(autoplayVideo, pmHolderId, videoSrc, '', adUrls, skipTime,
                adConfigs, playerReady);

            window.player.on("fullscreenchange", function () {
                if (window.player.isFullscreen()) {
                    // do something
                    window.player.muted(false);
                }
            });
        } else {
            $('#postMediaVideo, #btnPlayerVolume, #btnPlayerFullscreen').hide();
            $('#fbLikeBox').show();
        }
        autoPlaylistSetup();
    }

    function showPlayerInFullscreen() {
        if (isYoutube) {
            player.requestFullscreen()
        }
    }

    function volumePlayerUp() {
        window.player.muted(false);
        window.player.volume(1);
    }

    function autoPlaylistSetup(){
        var nodes = $('#recommended_posts a.suggested_item_post');
        if(nodes.length>2){
            $('#arrow_back').attr('href',$(nodes[0]).attr('href'));
            $('#arrow_forward').attr('href',$(nodes[1]).attr('href'));
        }
    }   

    window.mediaPlayerOneReady = function () {
        $('#fbLikeBox').show();
        setTimeout(loadVideo, 3678);
        setTimeout(function () {
            $('#videoProgressLoader').hide();
        }, 5000);

        loadSessionUserInfo(function () {
            var isEditable = canEditPost('{{ownerId}}');
            if (isEditable) {
                $('#btnEditPost').show()
            }
        });

        var fbUrl = 'https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(location.href);
        $('#fbSharer').attr('href', fbUrl);

        var w = $(window).width();
        if (w < 640) {
            var newW = w - 55;
            $('#postMediaInfo').css('width', newW + 'px');
        } else {
            $('#postMainContent').addClass('mdl-grid');
        }
    }
</script>