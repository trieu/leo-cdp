<div class="container-fluid">

    <div class="row">
        <div class="col-lg-10">
            <h4 class="page-header" id="page_breadcrumb" > </h4>
        </div>
        <div class="col-lg-2 text-center" style="padding: 10px">
        	<button type="button" class="btn btn-success" onclick="" > Save </button>
        	<button type="button" class="btn btn-secondary" onclick="" > Cancel </button>
        </div>
    </div>

    <div class="row gridholder" >
        <div class="col-lg-12">
        	<div class="row">
		       	 	<div id="journeyFlowChart" class="experience_journey_flow" style="height:420px;"></div>
		    </div>
            <div class="table-responsive">
                <div id="media_channels_table"></div>
            </div>
        </div>
    </div>

</div>

<script>
    var initMediaJourneyMap = initMediaJourneyMap || function() {
    	LeoAdminApiUtil.getSecuredData('/cdp/journeymap/get', { "id" : "" }, function(json){ 
	   		
	   		 
	   		var domSelector = '#journeyFlowChart';
	   		var defaultMetricName = json.data.defaultMetricName;
	   		var journeyStageMetrics = json.data.journeyStageMetrics;
	   		var journeyStages = json.data.journeyStages;
	   		var journeyLinks = json.data.journeyLinks;
	   		var journeyNodes =  json.data.journeyNodes;
	   		
	   		renderJourneyFlowChart(domSelector, defaultMetricName, journeyStages, journeyStageMetrics, journeyNodes, journeyLinks);
	   		
	   		var mediaChannelMap = json.data.mediaChannelMap;
	   		var mediaChannels = [];
	   		for(var str in mediaChannelMap){
	   			var index = mediaChannelMap[str];
	   			var json = JSON.parse(unescape(str));
	   			console.log(index)
	   			console.log(json)
	   			json.index = index;
	   			mediaChannels[index] = json;
	   		}
	   		
	   		//console.log(mediaChannelMap);	
	   		
	   		
	   		 $("#media_channels_table").jsGrid({
	   		    width: "100%",
	   		    height: "auto",
	
	   		    inserting: false,
	   		    editing: true,
	   		    sorting: true,
	   		    paging: false,
	   		    
	   		    deleteConfirm: function(item) {
	   	            return "The event \"" + item.eventName + "\" will be removed. Are you sure?";
	   	        },
	
	   		    data: mediaChannels,
	   		    
		   	
	   		    onItemInserting: function(args) {
	   		    	//console.log(args.item)
	   		    	
	   		    },      
	   		    onItemInserted: function(args) {
	   		    	//console.log(args.item)
	   		    	//console.log(behavioralMetricsData)
	   		    }, 
	   		    onItemDeleting: function(args) {
	   		        console.log(args.item)
	   		    },
	
	   		    fields: [
	   		    	{ name: "index", title : "Index", type: "number", width: 8, editing: false, validate: "required" },
	   		        { name: "name", title : "Channel Name", type: "text", width: 40, validate: "required" },
	   		     	{ name: "isOwnedMedia", title : "Owned Media", type: "checkbox", width: 23, validate: "required" },
	   		     	{ name: "url", title : "URL", type: "text", validate: "required" },
	   		     
	   		        { type: "control" , width: 20}
	   		    ]
	   		});  
	   	})
    }    
    
   
</script>