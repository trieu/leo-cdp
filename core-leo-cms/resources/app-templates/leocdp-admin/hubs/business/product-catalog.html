


<div id="spreadsheet"></div>


<script>
var urlDataSource = "/public/sample-data/books.json?_=" + new Date().getTime();

var initProductCatalog = function() {
    mySpreadsheet = jexcel(document.getElementById('spreadsheet'), {
        url: urlDataSource ,
        columns: [
            {
                type: 'text',
                width: '50px',
                title: 'Code',
                name: 'id',
                readOnly: true,
                primaryKey: true
            },
            {
                type: 'text',
                width: '80px',
                title:'Image',
                name:'thumbnailUrl'
            },
            {
                type: 'text',
                width: '200px',
                title:'Title',
                name:'title'
            },
            {
                type: 'text',
                width: '55px',
                title:'Pages',
                name:'pageCount'
            },
            {
                type: 'calendar',
                width: '90px',
                title:'Published',
                name: 'publishedDate'
            },
            {
                type: 'text',
                width: '200px',
                title:'Author',
                name:'authors'
            },
            {
                type: 'dropdown',
                width: '180px',
                title:'Categories',
                name:'categories',
                source:['Internet','Web Development', 'Java', 'Mobile', 'Open Source'],
                multiple:true
            },
         ],
         persistance: '/jexcel/v4/save',
         updateTable: function(instance, cell, col, row, val, label, cellName) {
             if (col == 1) {
                 if (! val) {
                     cell.innerHTML = '<img src="https://images-na.ssl-images-amazon.com/images/I/21%2Bwfxx2lyL._SX319_BO1,204,203,200_.jpg" style="width:30px;">';
                 } else {
                     cell.innerHTML = '<img src="' + val + '" style="width:30px;">';
                 }
             }

             cell.style.overflow = 'hidden';
         }
    });
};

setTimeout(initProductCatalog,1000)
</script>

<br>

https://bossanova.uk/jexcel/v4/examples/datatables

https://bossanova.uk/jexcel/v4/examples/events