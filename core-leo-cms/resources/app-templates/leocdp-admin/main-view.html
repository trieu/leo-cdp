<!-- Navigation -->
<nav id="main_cms_navigation" class="navbar navbar-fixed-top" role="navigation" style="display: none;">

	<div class="navbar-header">
		<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
			<span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span>
			<span class="icon-bar"></span> <span class="icon-bar"></span>
		</button>

		<a class="navbar-brand" href="/admin">
			<img id="logo-img" src="" alt="MainLogo" style="display: none;" />
		</a>

		<div style="width: 100%;">
			<input id="main_search" type="text" placeholder="Enter keywords">
		</div>

		<!-- Top Menu Items -->
		<ul class="nav navbar-right top-nav">

			<li class="dropdown"><a href="javascript:" class="dropdown-toggle" data-toggle="dropdown">
					<i class="fa fa-user"></i> <span id="userDisplayName"></span> <b class="caret"></b>
				</a>
				<ul class="dropdown-menu">
					<li><a href="#calljs-leoCdpRouter('My_Login_Info')"> <i class="fa fa-fw fa-user"></i> My Login Info </a> </li>
						
					<li style="display: none;" > <a href="#"> <i class="fa fa-fw fa-envelope"></i> Inbox </a> </li>
					<li style="display: none;" > <a href="#"> <i class="fa fa-fw fa-gear"></i> Settings </a> </li>
						
					<li class="divider"></li>
					<li>
						<a href="javascript:LeoCmsApiUtil.logout()"> <i class="fa fa-fw fa-power-off"></i> Log Out</a>
					</li>
				</ul>
			</li>

		</ul>
	</div>

	<!-- Sidebar Menu Items -->
	<div id="main-navbar" class="collapse navbar-collapse navbar-ex1-collapse">
		<ul class="nav navbar-nav side-nav">
			<li id="nav_data_analytics_hub" style="display: ;" >
				<a class="top_nav_item" href="javascript:;" data-toggle="collapse" data-target="#data_analytics_hub_menu"> <i class="fa fa-fw fa-line-chart"></i>
				 	Unified Analytics Hub <i id="data_analytics_hub_collapse_icon" class="fa fa-fw fa-caret-down"></i>
				</a>
				<ul id="data_analytics_hub_menu" class="collapse in" aria-expanded="true">
					<li>
						<a href="#calljs-leoCdpRouter('Marketing_Dashboard')"> <i class="fa fa-fw fa-pie-chart"></i> Marketing Dashboard </a>
					</li>
				</ul>
			</li>
		
			<!--  1 - Customer Journey Map Menu  -->
			<li id="nav_content_hub" style="display: ;" >
				<a class="top_nav_item" href="javascript:;" data-toggle="collapse" data-target="#journey_hub_menu"> <i class="fa fa-fw fa-map-o"></i>
				 	Customer Journey Hub<i id="journey_hub_collapse_icon" class="fa fa-fw fa-caret-down"></i>
				</a>
				<ul id="journey_hub_menu" class="collapse in" aria-expanded="true">
				
					
					<li style="display: none;" >
						<a href="#calljs-leoCdpRouter('Customer_Persona_List')"> <i class="fa fa-fw fa-users"></i> Customer Persona List</a>
					</li>
					
					<li>
						<a href="#calljs-leoCdpRouter('Media_Channel_List')"> <i class="fa fa-fw fa-exchange"></i> Media Channel List</a>
					</li>
					
					<li>
						<a href="#calljs-leoCdpRouter('Event_Metrics')"> <i class="fa fa-fw fa-list-ol"></i> Event Tracking Metrics </a>
					</li>
						
					<li>
						<a href="#calljs-leoCdpRouter('Data_Observer_List')"> <i class="fa fa-fw fa-camera"></i> Data Observer List</a>
					</li>
					
					<li style="display: none;" >
						<a href="#calljs-leoCdpRouter('Customer_Journey_List')"> <i class="fa fa-fw fa-map-o"></i> Customer Journey List</a>
					</li>
					
					<li style="display: none;" >
						<a href="#calljs-leoCdpRouter('Products_and_Services')"> <i class="fa fa-fw fa-database"></i> Products and Services</a>
					</li>
					
					<li style="display: none;" >
						<a href="#calljs-leoCdpRouter('Customer_Journey_API')"> <i class="fa fa-fw fa-plug"></i> Journey Hub API</a>
					</li>
					
				</ul>
			</li>
			
			<!--  2 - Creative Content Hub Menu  -->
			<li id="nav_content_hub" style="display: none;" >
				<a class="top_nav_item" href="javascript:;" data-toggle="collapse" data-target="#content_hub_menu"> <i class="fa fa-fw fa-sitemap"></i>
					Creative Content Hub <i id="content_hub_collapse_icon" class="fa fa-fw fa-caret-down"></i>
				</a>
				<ul id="content_hub_menu" class="collapse in" aria-expanded="true">
				
					<li>
						<a href="#calljs-leoCdpRouter('Content_Dashboard')"> <i class="fa fa-fw fa-bar-chart"></i> Content Dashboard</a>
					</li>
					
					<li>
						<a href="#calljs-leoCdpRouter('Content_Category_List')"> <i class="fa fa-fw fa-list-ol" ></i> Content Category List</a>
					</li>
					
					<li>
						<a href="#calljs-leoCdpRouter('Creative_Content_Hub_API')"  > <i class="fa fa-fw fa-plug"></i> Content Hub API</a>
					</li>
					
					<li>
						<a href="#calljs-leoCdpRouter('Copywriting_Marketplace')"  > <i class="fa fa-fw fa-exchange"></i> Copywriting Marketplace</a>
					</li>
					
				</ul>
			</li>
		
			<!--  3 - Customer Data Hub Menu  -->
			<li>
				<a class="top_nav_item" href="javascript:;" data-toggle="collapse" data-target="#customer_data_hub_menu"> <i class="fa fa-fw fa-users"></i>
					Customer Data Hub <i id="customer_data_hub_collapse_icon" class="fa fa-fw fa-caret-down"></i>
				</a>
				<ul id="customer_data_hub_menu" class="collapse in" aria-expanded="true">
					
					
					
					<li>
						<a href="#calljs-leoCdpRouter('Customer_Profile_List')"> <i class="fa fa-fw fa-address-card-o"></i> Customer Profile List</a>
					</li>
					
					<li>
						<a href="#calljs-leoCdpRouter('Customer_Segment_List')"> <i class="fa fa-fw fa-object-group"></i> Customer Segment List</a>
					</li>
					
					<li>
						<a href="#calljs-leoCdpRouter('Customer_Data_Export')"> <i class="fa fa-fw fa-download"></i> Customer Data Import</a>
					</li>
					
					<li>
						<a href="#calljs-leoCdpRouter('Customer_Data_Export')"> <i class="fa fa-fw fa-upload"></i> Customer Data Export</a>
					</li>
					
					
					
					<li style="display: none;" >
						<a href="#calljs-leoCdpRouter('Marketing_Hub_API')"> <i class="fa fa-fw fa-plug"></i> Marketing Hub API</a>
					</li>
					
				</ul>
			</li>

			

			<!--  4 - Personalization Content Management  -->
			<li id="nav_personalization_hub" style="display: none;"  >
				<a class="top_nav_item" href="javascript:;" data-toggle="collapse" data-target="#personalization_hub_menu"> <i class="fa fa-fw fa-user-circle-o "></i>
					Personalization AI Hub <i id="personalization_hub_collapse_icon" class="fa fa-fw fa-caret-down"></i>
				</a>
				<ul id="personalization_hub_menu" class="collapse in" aria-expanded="true">		
							
					<li>
						<a href="#calljs-leoCdpRouter('Personalization_Models')"> <i class="fa fa-fw fa-user-circle"></i> Personalization Models</a>
					</li>	
					
					<li style="display: none;" >
						<a href="#calljs-leoCdpRouter('Personalization_Widgets')"> <i class="fa fa-fw fa-internet-explorer"></i> Personalization Widgets</a>
					</li>
					
					<li style="display: none;" >
						<a href="#calljs-leoCdpRouter('')"  > <i class="fa fa-fw fa-plug"></i> Personalization Hub API</a>
					</li>
					
				</ul>
			</li>
			
			<!--  5 - Marketing & Sales Campaign Activation Management  -->
			<li id="nav_activation_hub" style="display: ;" >
				<a class="top_nav_item" href="javascript:;" data-toggle="collapse" data-target="#activation_hub_menu"><i class="fa fa-fw fa-heart"></i>
					Customer Activation <i id="activation_hub_collapse_icon" class="fa fa-fw fa-caret-down"></i>
				</a>
				<ul id="activation_hub_menu" class="collapse in" aria-expanded="true" >
					
					<li style="display: none;" >
						<a href="#calljs-leoCdpRouter('Coupon_Management')"> <i class="fa fa-fw fa-percent"></i> Coupon Management</a>
					</li>
					
					<li>
						<a href="#calljs-leoCdpRouter('Email_Campaigns')"> <i class="fa fa-fw fa-envelope-o"></i> Email Campaigns</a>
					</li>
					
					<li style="display: none;" >
						<a href="#calljs-leoCdpRouter('Push_Message_Campaigns')"> <i class="fa fa-fw fa-paper-plane"></i> Notification Campaigns</a>
					</li>
					
					<li style="display: none;" >
						<a href="#calljs-leoCdpRouter('')"  > <i class="fa fa-fw fa-list-ol"></i> Branding Campaigns</a>
					</li>
					
					<li style="display: none;" >
						<a href="#calljs-leoCdpRouter('')" > <i class="fa fa-fw fa-list-ol"></i> Performance Campaigns</a>
					</li>
					
					<li style="display: none;" >
						<a href="#calljs-leoCdpRouter('')"  > <i class="fa fa-fw fa-plug"></i> Activation Campaign API </a>
					</li>
					
				</ul>
			</li>

			<!--  6 - Core System Management  -->
			<li id="nav_system_management" >
				<a class="top_nav_item" href="javascript:;" data-toggle="collapse" data-target="#system_management_menu"> <i class="fa fa-cogs" aria-hidden="true"></i>
					System Management <i id="system_management_collapse_icon" class="fa fa-fw fa-caret-down"></i>
				</a>
				<ul id="system_management_menu" class="collapse in" aria-expanded="true">
					<li>
						<a href="#calljs-leoCdpRouter('User_Login_List')"> <i class="fa fa-user-plus" aria-hidden="true"></i>  User Login List</a>
					</li>
					<li  >
						<a href="#calljs-leoCdpRouter('System_Configuration')"> <i class="fa fa-cog" aria-hidden="true"></i> System Configuration</a>
					</li>
				</ul>
			</li>

		</ul>
	</div>
	<!-- /.navbar-collapse -->
</nav>

<div id="page-main-notification" style="display: none;"> </div>

<div id="page-wrapper" >
	<!-- page data here -->
	<div id="page_main_content" class="container-fluid" >
		<div class="loader"></div>
	</div>
</div>


<script id='category-navigation-tpl' type='text/template'>
	<li>
		<a class="capitalize" href="#calljs-loadPagesOfCategory('{{key}}','{{name}}')" >
			<i class="fa fa-fw fa-folder-open"></i> {{name}} 
		</a>
	</li>
</script>


<script>
	/////////////////////////////// READY //////////////////////////////////
	
	function pageWrapperResize(){
		$('#page-wrapper').attr('style', 'width:'+($(window).width() - 234 ) + 'px!important');
	}
	
	$(window).resize(function() {
		pageWrapperResize();
	});
	
	function loadCategoryNavigation() {
	    LeoCmsApiUtil.callPostAdminApi(baseAdminApi + '/category/list-all', {}, function (rs) {
	        if (rs.data && rs.httpCode === 0) {
	            var raw_template = $('#category-navigation-tpl').html();
	            var template = Handlebars.compile(raw_template);
	            var placeHolder = $('#content_hub_menu');
	            rs.data.forEach(function (e) {
	                //console.log(e);	
	                //e.name = toTitleCase(e.name);
	                var html = template(e);
	                placeHolder.append(html);
	            });
	            $('[title]').tooltip();
	        }
	    });
	}
	
	function loadCommonModalHtml() {
	    var list = [
	        '/view/common-widgets/query-filter-modal.html?admin=1',
	        '/view/common-widgets/post-type-selection-modal.html?admin=1',
	        '/view/common-widgets/confirm-delete-data-modal.html?admin=1',
	        '/view/common-widgets/leo-recommender.html?admin=1'
	    ];
	    list.forEach(function (e) {
	        loadModalboxHtml(e);
	    });
	}
	
	window.currentUserProfile = {'displayName':''};
	function loadUserInfoWidget() {
	    var urlStr = baseAdminApi + '/user/get-info';
	    LeoCmsApiUtil.callPostAdminApi(urlStr, {}, function (json) {
	        if (json.httpCode === 0 && json.errorMessage === '') {
	            if (json.data) {
	                var user = json.data;
	                $('#userDisplayName').html(user.displayName);
	                window.currentUserProfile = user;
	            }
	        }
	    });
	}
	
	function initMainSeach() {
		
	    var domSelector = "#main_search";
	    var options = {
	        url: window.baseAdminApi + "/post/keywords-for-search",
	        getValue: "name",
	        list: {
	            match: {
	                enabled: true
	            },
	            maxNumberOfElements: 10,
	            showAnimation: {
	                type: "slide",
	                time: 200
	            },
	            hideAnimation: {
	                type: "slide",
	                time: 200
	            },
	            sort: {
	                enabled: true
	            },
	            onSelectItemEvent: function () {
	                var node = $(domSelector);
	                var value = node.getSelectedItemData().name;
	                if (value) {
	                    node.val(value).trigger("change");
	                }
	            },
	            onChooseEvent: function () {
	                searchingByKeywords();
	            }
	        },
	        theme: "round"
	    };

	    $(domSelector).easyAutocomplete(options).on('keyup', function (e) {
	        if (e.keyCode == 13) {
	            searchingByKeywords();
	            $('.easy-autocomplete-container > ul').hide();
	        }
	    });
	}
	
	function navigationSetup(){
		
		//data_analytics_hub menu
		$("#data_analytics_hub_menu").on("hide.bs.collapse", function(){
        	$("#data_analytics_hub_collapse_icon").attr('class','fa fa-fw fa-caret-left');
        });
        $("#data_analytics_hub_menu").on("show.bs.collapse", function(){
        	$("#data_analytics_hub_collapse_icon").attr('class','fa fa-fw fa-caret-down');
        });
		
		//business menu
		$("#customer_data_hub_menu").on("hide.bs.collapse", function(){
        	$("#customer_data_hub_collapse_icon").attr('class','fa fa-fw fa-caret-left');
        });
        $("#customer_data_hub_menu").on("show.bs.collapse", function(){
        	$("#customer_data_hub_collapse_icon").attr('class','fa fa-fw fa-caret-down');
        });
         
        // content menu
		$("#content_hub_menu").on("hide.bs.collapse", function(){
        	$("#content_hub_collapse_icon").attr('class','fa fa-fw fa-caret-left');
        });
        $("#content_hub_menu").on("show.bs.collapse", function(){
         	$("#content_hub_collapse_icon").attr('class','fa fa-fw fa-caret-down');
        });
         
     	// journey hub menu
		$("#journey_hub_menu").on("hide.bs.collapse", function(){
        	$("#journey_hub_collapse_icon").attr('class','fa fa-fw fa-caret-left');
        });
        $("#journey_hub_menu").on("show.bs.collapse", function(){
         	$("#journey_hub_collapse_icon").attr('class','fa fa-fw fa-caret-down');
        });
        
     	// personalization menu
		$("#personalization_hub_menu").on("hide.bs.collapse", function(){
        	$("#personalization_hub_collapse_icon").attr('class','fa fa-fw fa-caret-left');
        });
        $("#personalization_hub_menu").on("show.bs.collapse", function(){
         	$("#personalization_hub_collapse_icon").attr('class','fa fa-fw fa-caret-down');
        });
         
        // activation menu
		$("#activation_hub_menu").on("hide.bs.collapse", function(){
        	$("#activation_hub_collapse_icon").attr('class','fa fa-fw fa-caret-left');
        });
        $("#activation_hub_menu").on("show.bs.collapse", function(){
        	$("#activation_hub_collapse_icon").attr('class','fa fa-fw fa-caret-down');
        });
        
     	// activation menu
		$("#system_management_menu").on("hide.bs.collapse", function(){
        	$("#system_management_collapse_icon").attr('class','fa fa-fw fa-caret-left');
        });
        $("#system_management_menu").on("show.bs.collapse", function(){
        	$("#system_management_collapse_icon").attr('class','fa fa-fw fa-caret-down');
        });
	}

	function mainViewReady() {
		if (isMobileDevice()) {
			var msg ='<div class="alert alert-info"> <strong> Leo CDP Admin</strong> is not supported on mobile browsers! </div>';
			$('#page-main-notification').show().html(msg);
		} else {
			
			//loadCategoryNavigation(); //FIXME
			pageWrapperResize();
			
			loadCommonModalHtml();
			loadUserInfoWidget();
			initMainSeach();
			navigationSetup();
			
			$('#main_cms_navigation').show();
			$('#logo-img').attr('src',window.pageHeaderLogo).show();
			
		}
	};
</script>